{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-location",
  "type": "registry:hook",
  "files": [
    {
      "path": "registry/default/hooks/use-location.ts",
      "content": "import { useState, useEffect } from \"react\";\r\n\r\ninterface Coordinates {\r\n  lat: number;\r\n  lon: number;\r\n}\r\n\r\ninterface LocationData {\r\n  coordinates: Coordinates | null;\r\n  city: string | null;\r\n  error: string | null;\r\n  isLoading: boolean;\r\n}\r\n\r\nconst DEFAULT_LOCATION: Coordinates = {\r\n  lat: 19.076, // Mumbai\r\n  lon: 72.8777,\r\n};\r\n\r\nexport function useLocation(): LocationData {\r\n  const [coordinates, setCoordinates] = useState<Coordinates | null>(null);\r\n  const [city, setCity] = useState<string | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState<boolean>(true);\r\n\r\n  useEffect(() => {\r\n    if (!navigator.geolocation) {\r\n      setError(\"Geolocation is not supported by your browser\");\r\n      setCoordinates(DEFAULT_LOCATION);\r\n      setCity(\"Mumbai\");\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      async (position) => {\r\n        const { latitude, longitude } = position.coords;\r\n        setCoordinates({ lat: latitude, lon: longitude });\r\n\r\n        try {\r\n          const response = await fetch(\r\n            `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${latitude}&longitude=${longitude}&localityLanguage=en`,\r\n          );\r\n          const data = await response.json();\r\n          setCity(data.city || data.locality || \"Unknown Location\");\r\n        } catch (err) {\r\n          console.error(\"Failed to fetch city name:\", err);\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      },\r\n      async (err) => {\r\n        console.warn(\r\n          \"Geolocation denied or failed, attempting IP fallback:\",\r\n          err.message,\r\n        );\r\n\r\n        try {\r\n          const response = await fetch(\"https://ipapi.co/json/\");\r\n          if (!response.ok) throw new Error(\"IP API failed\");\r\n\r\n          const data = await response.json();\r\n          if (data.latitude && data.longitude) {\r\n            setCoordinates({ lat: data.latitude, lon: data.longitude });\r\n            setCity(data.city || data.region || \"Unknown Location\");\r\n            setError(null);\r\n          } else {\r\n            throw new Error(\"Invalid IP data\");\r\n          }\r\n        } catch (ipErr) {\r\n          console.error(\r\n            \"IP Geoloc outcome failed, defaulting to Mumbai:\",\r\n            ipErr,\r\n          );\r\n          setError(err.message);\r\n          setCoordinates(DEFAULT_LOCATION);\r\n          setCity(\"Mumbai\");\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      },\r\n    );\r\n  }, []);\r\n\r\n  return { coordinates, city, error, isLoading };\r\n}\r\n",
      "type": "registry:hook"
    }
  ]
}